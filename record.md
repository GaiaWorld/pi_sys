
# ##################################################
# 20191120

## 调整
### 调整部分返回与分支代码
* 方便调试断点
### Blob 引入后结构调整
* 批下载与单文件下载均通过统一流程获得ArrayBuffer数据
### Download onResult 调用时参数错误
* 需要传入文件数据表
### 添加临时本地文件签名表
* 文件通过批下载下来，即认为该文件已成为为本地文件
* 后续的再次请求将通过是否为本地文件的验证,通过LocalLoad获得数据
* 原来的情况是 仅一张签名表,文件通过写本地成功后才记录到本地文件签名表
* 添加的 临时本地文件签名表用于请求时判断 - 文件下载下来即认为是本地文件，不管是否已写成功,因为是临时的，所以即使当前未写成功，而重新进入游戏,临时签名表由写成功时保持的签名表初始化，将正确发起未写本地的文件的下载

## 增加
### 增加了 Web 声音的实现

## 问题
### 写文件耗时久，内存大 - 川菜当前Storage为 1028M
### 缺少: 文件加载起来时不等待写本地结束即返回ArrayBuffer
* 处理: store 模块添加 dataMap 
* 外部 调用write方法时 保存传入的文件数据，写本地成功后移除
* 外部 调用read方法时 先从 dataMap 取,没有数据再从本地读取

# ##################################################
# 20191121

## 遗留
* Web 写文件耗时久，内存大 - 川菜当前Storage为 1028M,现为 802M
* 原因: 保存的 Uint8Array 为一个大ArrayBuffer的一小段数据,保存到DB时需要整个 ArrayBuffer 作为 Uint8Array 的访问目标，导致保存了额外的数据

## 调整

### weapp-adapter 库,修改 Audio 模块
* 添加 destroy 方法,释放资源
### 实现 minigame 下 Sound.ts
* 实现 sound.ts,管理与web不同,所有音乐都独立使用audio标签播放
* 接入游戏逻辑，真机背景音乐播放成功，真机按钮音效播放成功,切换打开/关闭声音控制成功
* 背景音乐关闭时，音乐资源不释放，以保证再次开启时正常运行 - (原因在于此处实现时自己创建了Audio，不是底层创建的)
### minigame 下图片加载调整
* 适应 babylon 接入时,外部传入已创建的Image对象,底层不再创建
### web 版背景音乐修复
* 背景音乐关闭时，音乐资源不移出列表，以保证再次开启时正常运行 - (原因在于此处实现时自己创建了Audio，不是底层创建的)
### web 版普通声音调整
* 不在 sound 模块中解码 arrayBuffer 为 AudioBuffer
* 在 audio 模块，加载到文件数据arrayBuffer时，即进行解码，同时AudioBuffer作为缓存资源，而不再是 arrayBuffer
### web stroe 调整
* 保存与删除与读取使用的键名 由原来的文件路径修改为文件签名
* 测试: 通过修改图片文件,运行时成功删除旧文件,使用新文件

## 协助川菜项目实现模板效果，并保证消除该实现对混合渲染造成的影响
* 已结束
## 协助三国项目 小游戏运行测试？
* 

# ##################################################
# 20191122

## 小游戏字体，小游戏音乐模块；Web字体，Web音乐模块
* 完成并真机测试通过


# ##################################################
# 20191125

## 日志
* 已修改构建器注入模块名称

## ***构建器申请大内存 => 物理内存不足 => 开辟更多虚拟内存 => 激发ntoskrnl.exe管理内存,电脑变慢; 构建器关闭仍未恢复(关闭后内存需求没有撤销？关闭后内存需求撤销后,ntoskrnl.exe工作异常？)
## ***合并下载后，数据取得 大 ArrayBuffer 中一部分，使用Uint8Array 视图, 如果使用的Uint8Array未销毁 大的 ArrayBuffer 始终会存活在内存 
* Web 下川菜项目测试


# ##################################################
# 20191126

## 日志关闭/激活的控制方法
* 以九宫格划分canvas, 按一定点击顺序实现控制规则

## 添加 resTab 的打印
* 调试/验证 资源的释放

## 处理合并下载下来的数据
* 切分得到 Uint8Array 使用后置为 undefined
## *** GUI 切分等到的 样式/配置等 未能销毁，即导致合并下载时的 ArrayBufffer 始终存活

## 原Babylon 应用，川菜项目, Web 端资源下载 通过 LoadFile -> ResTab 下载 File 资源 -> 被合并 -> 远端下载
* 有个疑问: 批下载只会是远端下载？项目打包后，如果是走批下载，一定还是远端下载？

# ##################################################
# 20191127

## 验证小游戏
* 加载运行正常

## ***新的canvas适配后 点击响应出现问题,有节点命中，没有找到事件绑定？